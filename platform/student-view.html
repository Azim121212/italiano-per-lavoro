<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –æ–±—É—á–µ–Ω–∏—è - –°—Ç—É–¥–µ–Ω—Ç (–û—Ç–∫—Ä—ã—Ç—ã–π –¥–æ—Å—Ç—É–ø)</title>
    <link rel="stylesheet" href="styles/platform.css">
</head>
<body>
    <!-- Student Dashboard -->
    <div id="studentDashboard" class="dashboard">
        <header class="dashboard-header">
            <div class="header-left">
                <h1>IL Learning Platform</h1>
                <span class="user-badge student">–°—Ç—É–¥–µ–Ω—Ç</span>
            </div>
            <div class="header-right">
                <div class="user-info">
                    <span id="studentName">–°—Ç—É–¥–µ–Ω—Ç</span>
                    <span class="points-badge" id="studentPoints">0 –æ—á–∫–æ–≤</span>
                </div>
            </div>
        </header>

        <div class="dashboard-container">
            <!-- Sidebar -->
            <aside class="dashboard-sidebar">
                <nav class="sidebar-nav">
                    <a href="#courses" class="nav-item active" data-section="courses">
                        <span class="nav-icon">üìö</span>
                        <span>–ú–æ–∏ –∫—É—Ä—Å—ã</span>
                    </a>
                    <a href="../trial-lesson/index.html" class="nav-item" target="_blank">
                        <span class="nav-icon">üéì</span>
                        <span>–ü—Ä–æ–±–Ω—ã–π —É—Ä–æ–∫</span>
                    </a>
                    <a href="#progress" class="nav-item" data-section="progress">
                        <span class="nav-icon">üìä</span>
                        <span>–ü—Ä–æ–≥—Ä–µ—Å—Å</span>
                    </a>
                    <a href="#grades" class="nav-item" data-section="grades">
                        <span class="nav-icon">‚≠ê</span>
                        <span>–û—Ü–µ–Ω–∫–∏</span>
                    </a>
                    <a href="#leaderboard" class="nav-item" data-section="leaderboard">
                        <span class="nav-icon">üèÜ</span>
                        <span>–†–µ–π—Ç–∏–Ω–≥</span>
                    </a>
                </nav>
            </aside>

            <!-- Main Content -->
            <main class="dashboard-content">
                <!-- Courses Section -->
                <section id="coursesSection" class="content-section active">
                    <h2>–ú–æ–∏ –∫—É—Ä—Å—ã</h2>
                    <div id="studentCourses" class="courses-grid">
                        <!-- Courses will be loaded here -->
                    </div>
                </section>

                <!-- Progress Section -->
                <section id="progressSection" class="content-section">
                    <h2>–ú–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å</h2>
                    <div class="progress-overview">
                        <div class="progress-card">
                            <h3>–û–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å</h3>
                            <div class="progress-bar-container">
                                <div class="progress-bar" id="overallProgress">
                                    <div class="progress-fill" style="width: 0%"></div>
                                </div>
                                <span class="progress-text" id="overallProgressText">0%</span>
                            </div>
                        </div>
                        <div class="stats-grid">
                            <div class="stat-item">
                                <div class="stat-value" id="completedLessons">0</div>
                                <div class="stat-label">–ó–∞–≤–µ—Ä—à–µ–Ω–æ —É—Ä–æ–∫–æ–≤</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value" id="totalPoints">0</div>
                                <div class="stat-label">–í—Å–µ–≥–æ –æ—á–∫–æ–≤</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value" id="averageGrade">0</div>
                                <div class="stat-label">–°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª</div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Grades Section -->
                <section id="gradesSection" class="content-section">
                    <h2>–ú–æ–∏ –æ—Ü–µ–Ω–∫–∏</h2>
                    <div id="gradesList" class="grades-list">
                        <!-- Grades will be loaded here -->
                    </div>
                </section>

                <!-- Leaderboard Section -->
                <section id="leaderboardSection" class="content-section">
                    <h2>–†–µ–π—Ç–∏–Ω–≥ –≥—Ä—É–ø–ø—ã</h2>
                    <div id="leaderboard" class="leaderboard">
                        <!-- Leaderboard will be loaded here -->
                    </div>
                </section>
            </main>
        </div>
    </div>

    <!-- Lesson View -->
    <div id="lessonView" class="lesson-view" style="display: none;">
        <header class="lesson-header">
            <button class="btn btn-secondary" id="backToCourses">‚Üê –ù–∞–∑–∞–¥ –∫ –∫—É—Ä—Å–∞–º</button>
            <h2 id="lessonTitle">–£—Ä–æ–∫</h2>
            <div class="lesson-progress">
                <span>–ü—Ä–æ–≥—Ä–µ—Å—Å —É—Ä–æ–∫–∞: </span>
                <div class="progress-bar small">
                    <div class="progress-fill" id="lessonProgressFill" style="width: 0%"></div>
                </div>
                <span id="lessonProgressText">0%</span>
            </div>
        </header>

        <div class="lesson-container">
            <div class="lesson-content">
                <!-- Lesson content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div id="modalOverlay" class="modal-overlay" style="display: none;">
        <div class="modal" id="modal">
            <!-- Modal content -->
        </div>
    </div>

    <script src="../scripts/state-manager.js"></script>
    <script src="scripts/platform-api.js"></script>
    <script src="scripts/student.js"></script>
    <script>
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–µ–º–æ-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å—Ç—É–¥–µ–Ω—Ç–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('DOMContentLoaded', function() {
            setTimeout(function() {
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
                if (!localStorage.getItem('platform_courses')) {
                    PlatformAPI.initDemoData();
                }
                
                // –°–æ–∑–¥–∞–µ–º –∏–ª–∏ –ø–æ–ª—É—á–∞–µ–º –¥–µ–º–æ-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å—Ç—É–¥–µ–Ω—Ç–∞
                let demoStudent = PlatformAPI.getCurrentUser();
                
                if (!demoStudent || demoStudent.role !== 'student') {
                    // –°–æ–∑–¥–∞–µ–º –¥–µ–º–æ-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å—Ç—É–¥–µ–Ω—Ç–∞
                    const users = PlatformAPI.getUsers();
                    let studentUser = users.find(u => u.role === 'student');
                    
                    if (!studentUser) {
                        // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–≥–æ –¥–µ–º–æ-—Å—Ç—É–¥–µ–Ω—Ç–∞
                        studentUser = {
                            id: Date.now(),
                            email: 'demo@student.com',
                            password: 'demo123',
                            role: 'student',
                            name: '–î–µ–º–æ –°—Ç—É–¥–µ–Ω—Ç',
                            groupId: 1
                        };
                        
                        users.push(studentUser);
                        localStorage.setItem('platform_users', JSON.stringify(users));
                    }
                    
                    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑—É–µ–º –¥–µ–º–æ-—Å—Ç—É–¥–µ–Ω—Ç–∞
                    localStorage.setItem('platform_user', JSON.stringify(studentUser));
                    demoStudent = studentUser;
                }
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–∞—à–±–æ—Ä–¥ —Å—Ç—É–¥–µ–Ω—Ç–∞
                const studentDashboard = document.getElementById('studentDashboard');
                if (studentDashboard) {
                    studentDashboard.style.display = 'flex';
                    
                    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–∞—à–±–æ—Ä–¥
                    if (typeof StudentDashboard !== 'undefined' && StudentDashboard.init) {
                        StudentDashboard.init();
                    }
                }
            }, 100);
        });
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥ –∫ –∫—É—Ä—Å–∞–º"
        document.getElementById('backToCourses')?.addEventListener('click', function() {
            if (typeof StudentDashboard !== 'undefined' && StudentDashboard.backToCourses) {
                StudentDashboard.backToCourses();
            }
        });
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ –≤–Ω–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        document.getElementById('modalOverlay')?.addEventListener('click', function(e) {
            if (e.target === this) {
                this.style.display = 'none';
            }
        });
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ ESC –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                const overlay = document.getElementById('modalOverlay');
                if (overlay && overlay.style.display === 'flex') {
                    overlay.style.display = 'none';
                }
            }
        });
    </script>
</body>
</html>

